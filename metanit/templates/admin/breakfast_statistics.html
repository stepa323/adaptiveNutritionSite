{% extends "admin/base_site.html" %}

{% block content %}

<!-- –ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
<div style="margin-bottom: 20px;">
    <a href="{% url 'admin:pupils_weeklybreakfasts_export_excel' %}" class="button"
       style="background-color: #217346; color: white;">
        üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
    </a>
    <a href="{% url 'admin:pupils_weeklybreakfasts_changelist' %}" class="button">
        ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É —É—á–µ–Ω–∏–∫–æ–≤
    </a>
</div>

{% for class_stat in classes_stats %}

<div class="module">
    <h2>–ö–ª–∞—Å—Å: {{ class_stat.class.name }}</h2>
    <p><strong>–í—Å–µ–≥–æ —É—á–µ–Ω–∏–∫–æ–≤: {{ class_stat.total_pupils }}</strong></p>

    <table style="width: 100%; border-collapse: collapse;">
        <thead>
        <tr style="background-color: #f5f5f5;">
            <th style="padding: 8px; border: 1px solid #ddd;">–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏</th>
            <th style="padding: 8px; border: 1px solid #ddd;">–í–∞—Ä–∏–∞–Ω—Ç 1</th>
            <th style="padding: 8px; border: 1px solid #ddd;">–í–∞—Ä–∏–∞–Ω—Ç 2</th>
            <th style="padding: 8px; border: 1px solid #ddd;">–ù–µ –≤—ã–±—Ä–∞–ª–∏</th>
            <th style="padding: 8px; border: 1px solid #ddd;">–í—ã–±—Ä–∞–ª–∏</th>
        </tr>
        </thead>
        <tbody>
        {% for day_name, day_data in class_stat.day_stats.items %}
        <tr>
            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">
                {% if day_name == 'monday' %}–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
                {% elif day_name == 'tuesday' %}–í—Ç–æ—Ä–Ω–∏–∫
                {% elif day_name == 'wednesday' %}–°—Ä–µ–¥–∞
                {% elif day_name == 'thursday' %}–ß–µ—Ç–≤–µ—Ä–≥
                {% elif day_name == 'friday' %}–ü—è—Ç–Ω–∏—Ü–∞{% endif %}
            </td>

            {% comment %} –í–∞—Ä–∏–∞–Ω—Ç 1 –∏ 2 –∏–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–ª—é–¥ {% endcomment %}
            <td style="padding: 8px; border: 1px solid #ddd;">
                {% for dish, count in day_data.dishes.items %}
                {% if forloop.first %}{{ dish }}: <strong>{{ count }}</strong>{% endif %}
                {% empty %}
                -
                {% endfor %}
            </td>

            <td style="padding: 8px; border: 1px solid #ddd;">
                {% for dish, count in day_data.dishes.items %}
                {% if forloop.counter == 2 %}{{ dish }}: <strong>{{ count }}</strong>{% endif %}
                {% endfor %}
            </td>

            <td style="padding: 8px; border: 1px solid #ddd; color: {% if day_data.not_chosen > 0 %}red{% else %}green{% endif %};">
                <strong>{{ day_data.not_chosen }}</strong>
            </td>

            <td style="padding: 8px; border: 1px solid #ddd; font-weight: bold;">
                {{ day_data.chosen }}
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endfor %}

<div style="margin-top: 20px;">
    <a href="{% url 'admin:pupils_weeklybreakfasts_changelist' %}" class="button">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É —É—á–µ–Ω–∏–∫–æ–≤</a>
</div>
{% endblock %}